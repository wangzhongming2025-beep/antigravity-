<!DOCTYPE html>
<html lang="zh-CN" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¹°çœ¼ç‰¹ç§å…µÂ·è„‘è§†è§‰é›·è¾¾ä½“æ£€ | 299å…ƒä¸“ä¸šæµ‹è¯„</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Inter:wght@400;600;800&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #0a0a0a 100%);
            color: #e4e4e7;
            min-height: 100vh;
        }

        .tech-font {
            font-family: 'Orbitron', sans-serif;
        }

        .glass-panel {
            background: rgba(24, 24, 27, 0.85);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .glow-green {
            box-shadow: 0 0 30px rgba(16, 185, 129, 0.3);
        }

        .glow-red {
            box-shadow: 0 0 30px rgba(239, 68, 68, 0.3);
        }

        .glow-cyan {
            box-shadow: 0 0 30px rgba(6, 182, 212, 0.4);
        }

        .radar-container {
            position: relative;
        }

        .radar-container::before {
            content: '';
            position: absolute;
            inset: -2px;
            border-radius: 50%;
            background: conic-gradient(from 0deg, transparent 0%, #00ff88 50%, transparent 100%);
            animation: radar-sweep 4s linear infinite;
            opacity: 0.3;
        }

        @keyframes radar-sweep {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }

        .step-indicator {
            transition: all 0.3s ease;
        }

        .step-indicator.active {
            background: linear-gradient(135deg, #06b6d4, #10b981);
            transform: scale(1.2);
        }

        .step-indicator.completed {
            background: #10b981;
        }

        .option-card {
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .option-card:hover {
            transform: translateY(-2px);
            border-color: rgba(6, 182, 212, 0.5);
        }

        .option-card.selected {
            border-color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
        }

        .option-card.selected-good {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.1);
        }

        .schulte-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            max-width: 320px;
            margin: 0 auto;
        }

        .schulte-cell {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 800;
            background: rgba(24, 24, 27, 0.9);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .schulte-cell:hover {
            border-color: #06b6d4;
            transform: scale(1.05);
        }

        .schulte-cell.correct {
            background: rgba(16, 185, 129, 0.3);
            border-color: #10b981;
        }

        .schulte-cell.wrong {
            background: rgba(239, 68, 68, 0.3);
            border-color: #ef4444;
            animation: shake 0.3s ease;
        }

        @keyframes shake {

            0%,
            100% {
                transform: translateX(0);
            }

            25% {
                transform: translateX(-5px);
            }

            75% {
                transform: translateX(5px);
            }
        }

        .noise-grid {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 4px;
            font-family: monospace;
            font-size: 0.9rem;
        }

        .noise-cell {
            padding: 6px;
            text-align: center;
            background: rgba(24, 24, 27, 0.5);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.1s ease;
        }

        .noise-cell:hover {
            background: rgba(6, 182, 212, 0.2);
        }

        .noise-cell.found {
            background: rgba(16, 185, 129, 0.4);
            color: #10b981;
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }
        }

        .slide-in {
            animation: slideIn 0.5s ease forwards;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>

<body class="p-4 md:p-8">
    <div class="max-w-2xl mx-auto">

        <!-- Header -->
        <header class="text-center mb-8">
            <div
                class="inline-block px-4 py-1 bg-red-500/20 text-red-400 text-xs font-bold rounded-full mb-4 uppercase tracking-widest">
                ğŸ–ï¸ é™æ—¶ç‰¹æƒ  Â¥299
            </div>
            <h1 class="tech-font text-2xl md:text-3xl text-white mb-2">
                é¹°çœ¼ç‰¹ç§å…µ<span class="text-cyan-400">Â·</span>è„‘è§†è§‰é›·è¾¾ä½“æ£€
            </h1>
            <p class="text-zinc-500 text-sm">ä¸“ä¸šè§†è§‰èƒ½åŠ›è¯„ä¼°ç³»ç»Ÿ | é€‚ç”¨6-15å²å­¦ç”Ÿ</p>
        </header>

        <!-- Progress Indicator -->
        <div class="flex justify-center gap-3 mb-8" id="progress-bar">
            <div class="step-indicator w-3 h-3 rounded-full bg-zinc-700" data-step="0"></div>
            <div class="step-indicator w-3 h-3 rounded-full bg-zinc-700" data-step="1"></div>
            <div class="step-indicator w-3 h-3 rounded-full bg-zinc-700" data-step="2"></div>
            <div class="step-indicator w-3 h-3 rounded-full bg-zinc-700" data-step="3"></div>
            <div class="step-indicator w-3 h-3 rounded-full bg-zinc-700" data-step="4"></div>
            <div class="step-indicator w-3 h-3 rounded-full bg-zinc-700" data-step="5"></div>
        </div>

        <!-- Step Container -->
        <div id="step-container">

            <!-- Step 0: Start -->
            <div class="step glass-panel rounded-3xl p-8 slide-in" id="step-0">
                <div class="text-center mb-8">
                    <div
                        class="w-20 h-20 bg-cyan-500/20 rounded-2xl flex items-center justify-center mx-auto mb-4 text-4xl glow-cyan">
                        ğŸ¦…
                    </div>
                    <h2 class="text-xl font-bold text-white mb-2">å¼€å§‹è§†è§‰é›·è¾¾ä½“æ£€</h2>
                    <p class="text-zinc-500 text-sm">è¯·å®¶é•¿å¡«å†™ä»¥ä¸‹ä¿¡æ¯ï¼Œè¾…åŠ©å­©å­å®Œæˆæµ‹è¯•</p>
                </div>

                <div class="space-y-4 mb-8">
                    <div>
                        <label class="block text-xs text-zinc-500 uppercase tracking-widest mb-2">å®¶é•¿æ‰‹æœºå·</label>
                        <input type="tel" id="input-phone" placeholder="è¾“å…¥æ‰‹æœºå·"
                            class="w-full bg-black/50 border border-zinc-800 rounded-xl p-4 text-white focus:outline-none focus:border-cyan-500 transition-colors">
                    </div>
                    <div>
                        <label class="block text-xs text-zinc-500 uppercase tracking-widest mb-2">å­©å­å§“å</label>
                        <input type="text" id="input-name" placeholder="è¾“å…¥å­©å­å§“å"
                            class="w-full bg-black/50 border border-zinc-800 rounded-xl p-4 text-white focus:outline-none focus:border-cyan-500 transition-colors">
                    </div>
                    <div>
                        <label class="block text-xs text-zinc-500 uppercase tracking-widest mb-2">å­©å­å¹´é¾„</label>
                        <input type="number" id="input-age" placeholder="6-15" min="6" max="15"
                            class="w-full bg-black/50 border border-zinc-800 rounded-xl p-4 text-white focus:outline-none focus:border-cyan-500 transition-colors">
                    </div>
                </div>

                <button onclick="startTest()"
                    class="w-full bg-gradient-to-r from-cyan-500 to-green-500 text-black font-black py-4 rounded-xl transition-all hover:scale-[1.02] active:scale-95 shadow-lg">
                    ğŸš€ å¼€å§‹ä½“æ£€
                </button>
            </div>

            <!-- Step 1: Eye Tracking -->
            <div class="step glass-panel rounded-3xl p-8 hidden" id="step-1">
                <div class="text-center mb-6">
                    <div
                        class="inline-block px-3 py-1 bg-cyan-500/20 text-cyan-400 text-xs font-bold rounded-full mb-4">
                        ç¬¬ä¸€é¡¹ / å…±å››é¡¹
                    </div>
                    <h2 class="text-xl font-bold text-white mb-2">ğŸ‘ï¸ çœ¼åŠ¨è¿½è¸ªèƒ½åŠ›æµ‹è¯•</h2>
                    <p class="text-zinc-500 text-sm">æµ‹è¯•"é˜…è¯»ä¸è·³è¡Œ"çš„èƒ½åŠ›</p>
                </div>

                <div class="glass-panel rounded-2xl p-4 mb-6 border-l-4 border-cyan-500">
                    <p class="text-sm font-bold text-white mb-2">ğŸ”§ é“å…·ï¼šä¸€æ”¯ç¬”</p>
                    <p class="text-sm text-zinc-400">
                        å®¶é•¿æ‰‹æŒç¬”ï¼Œåœ¨å­©å­çœ¼å‰ 40cm å¤„ï¼Œ<strong class="text-cyan-400">ç¼“æ…¢æ°´å¹³ç§»åŠ¨ï¼ˆå·¦å³ï¼‰</strong>ï¼Œç„¶å<strong
                            class="text-cyan-400">å¿«é€Ÿè·³è·ƒç§»åŠ¨</strong>ã€‚
                    </p>
                </div>

                <p class="text-xs text-zinc-500 mb-4 uppercase tracking-widest">è§‚å¯ŸæŒ‡æ ‡ï¼ˆè¯·å‹¾é€‰ç¬¦åˆçš„æƒ…å†µï¼‰</p>

                <div class="space-y-3 mb-8" id="part1-options">
                    <div class="option-card glass-panel rounded-xl p-4 border border-transparent" data-value="0"
                        data-good="true" onclick="toggleOption(this, 'part1')">
                        <div class="flex items-start gap-3">
                            <div
                                class="w-6 h-6 rounded-md border-2 border-zinc-600 flex items-center justify-center text-xs check-box">
                                âœ“</div>
                            <p class="text-sm text-zinc-300">å­©å­çš„çœ¼çƒèƒ½å¹³æ»‘åœ°è·Ÿç€ç¬”èµ°ï¼Œå¤´å®Œå…¨ä¸åŠ¨ã€‚<span
                                    class="text-green-400 ml-1">âœ…</span></p>
                        </div>
                    </div>
                    <div class="option-card glass-panel rounded-xl p-4 border border-transparent" data-value="1"
                        onclick="toggleOption(this, 'part1')">
                        <div class="flex items-start gap-3">
                            <div
                                class="w-6 h-6 rounded-md border-2 border-zinc-600 flex items-center justify-center text-xs check-box">
                                âœ“</div>
                            <p class="text-sm text-zinc-300">å­©å­çš„å¤´å¿ä¸ä½è·Ÿç€ç¬”ä¸€èµ·è½¬åŠ¨ã€‚<span class="text-red-400 ml-1">âŒ
                                    é¢ˆéƒ¨ä»£å¿</span></p>
                        </div>
                    </div>
                    <div class="option-card glass-panel rounded-xl p-4 border border-transparent" data-value="2"
                        onclick="toggleOption(this, 'part1')">
                        <div class="flex items-start gap-3">
                            <div
                                class="w-6 h-6 rounded-md border-2 border-zinc-600 flex items-center justify-center text-xs check-box">
                                âœ“</div>
                            <p class="text-sm text-zinc-300">ç¬”å¿«é€Ÿåœä¸‹æ—¶ï¼Œå­©å­è§†çº¿"å†²è¿‡å¤´"æˆ–"æ²¡è·Ÿä¸Š"ã€‚<span class="text-red-400 ml-1">âŒ
                                    çœ¼åŠ¨æ§åˆ¶å·®</span></p>
                        </div>
                    </div>
                    <div class="option-card glass-panel rounded-xl p-4 border border-transparent" data-value="3"
                        onclick="toggleOption(this, 'part1')">
                        <div class="flex items-start gap-3">
                            <div
                                class="w-6 h-6 rounded-md border-2 border-zinc-600 flex items-center justify-center text-xs check-box">
                                âœ“</div>
                            <p class="text-sm text-zinc-300">çœ¼ç›è½¬åŠ¨æ—¶ï¼Œä¼šæœ‰å¡é¡¿æˆ–çœ¨çœ¼ç°è±¡ã€‚<span class="text-red-400 ml-1">âŒ
                                    è§†è§‰ä¸“æ³¨åŠ›æ–­è£‚</span></p>
                        </div>
                    </div>
                </div>

                <button onclick="nextStep(2)"
                    class="w-full bg-gradient-to-r from-cyan-500 to-green-500 text-black font-black py-4 rounded-xl transition-all hover:scale-[1.02] active:scale-95">
                    ä¸‹ä¸€é¡¹ â†’
                </button>
            </div>

            <!-- Step 2: Binocular Fusion -->
            <div class="step glass-panel rounded-3xl p-8 hidden" id="step-2">
                <div class="text-center mb-6">
                    <div
                        class="inline-block px-3 py-1 bg-purple-500/20 text-purple-400 text-xs font-bold rounded-full mb-4">
                        ç¬¬äºŒé¡¹ / å…±å››é¡¹
                    </div>
                    <h2 class="text-xl font-bold text-white mb-2">ğŸ‘€ åŒçœ¼èåˆåŠŸèƒ½æµ‹è¯•</h2>
                    <p class="text-zinc-500 text-sm">æµ‹è¯•"çœ‹ä¹¦ä¸ç´¯"çš„èƒ½åŠ›</p>
                </div>

                <div class="glass-panel rounded-2xl p-4 mb-6 border-l-4 border-purple-500">
                    <p class="text-sm font-bold text-white mb-2">ğŸ”§ é“å…·ï¼šä½ çš„å¤§æ‹‡æŒ‡</p>
                    <p class="text-sm text-zinc-400">
                        è®©å­©å­ç›¯ç€å®¶é•¿æ”¾åœ¨ä»–<strong class="text-purple-400">é¼»å°–å‰ 10cm å¤„</strong>çš„å¤§æ‹‡æŒ‡ï¼Œ<strong
                            class="text-purple-400">ä¿æŒ 10 ç§’</strong>ã€‚
                    </p>
                </div>

                <p class="text-xs text-zinc-500 mb-4 uppercase tracking-widest">è§‚å¯ŸæŒ‡æ ‡ï¼ˆè¯·å‹¾é€‰ç¬¦åˆçš„æƒ…å†µï¼‰</p>

                <div class="space-y-3 mb-8" id="part2-options">
                    <div class="option-card glass-panel rounded-xl p-4 border border-transparent" data-value="0"
                        data-good="true" onclick="toggleOption(this, 'part2')">
                        <div class="flex items-start gap-3">
                            <div
                                class="w-6 h-6 rounded-md border-2 border-zinc-600 flex items-center justify-center text-xs check-box">
                                âœ“</div>
                            <p class="text-sm text-zinc-300">ä¸¤åªé»‘çœ¼ç éƒ½èƒ½ç´§ç´§èšåœ¨ä¸­é—´ï¼ˆæ–—é¸¡çœ¼çŠ¶ï¼‰ï¼Œä¸”ä¿æŒä¸åŠ¨ã€‚<span
                                    class="text-green-400 ml-1">âœ…</span></p>
                        </div>
                    </div>
                    <div class="option-card glass-panel rounded-xl p-4 border border-transparent" data-value="1"
                        onclick="toggleOption(this, 'part2')">
                        <div class="flex items-start gap-3">
                            <div
                                class="w-6 h-6 rounded-md border-2 border-zinc-600 flex items-center justify-center text-xs check-box">
                                âœ“</div>
                            <p class="text-sm text-zinc-300">ä¸€åªçœ¼ç›çœ‹è¿›æ¥äº†ï¼Œå¦ä¸€åªçœ¼ç›"é£˜"å‡ºå»äº†ã€‚<span class="text-red-400 ml-1">âŒ
                                    é›†åˆä¸è¶³/éšæ–œè§†</span></p>
                        </div>
                    </div>
                    <div class="option-card glass-panel rounded-xl p-4 border border-transparent" data-value="2"
                        onclick="toggleOption(this, 'part2')">
                        <div class="flex items-start gap-3">
                            <div
                                class="w-6 h-6 rounded-md border-2 border-zinc-600 flex items-center justify-center text-xs check-box">
                                âœ“</div>
                            <p class="text-sm text-zinc-300">å­©å­å–Š"å¤´æ™•"ã€"æœ‰ä¸¤ä¸ªæ‰‹æŒ‡"ï¼Œæˆ–è€…çœ¼ç›ç‹‚æµæ³ªã€‚<span class="text-red-400 ml-1">âŒ
                                    è§†è§‰ç–²åŠ³é˜ˆå€¼ä½</span></p>
                        </div>
                    </div>
                    <div class="option-card glass-panel rounded-xl p-4 border border-transparent" data-value="3"
                        onclick="toggleOption(this, 'part2')">
                        <div class="flex items-start gap-3">
                            <div
                                class="w-6 h-6 rounded-md border-2 border-zinc-600 flex items-center justify-center text-xs check-box">
                                âœ“</div>
                            <p class="text-sm text-zinc-300">åšæŒä¸åˆ° 3 ç§’ï¼Œçœ¼ç›å°±è‡ªåŠ¨æ•£å¼€äº†ã€‚<span class="text-red-400 ml-1">âŒ
                                    è°ƒèŠ‚åŠ›å´©å¡Œ</span></p>
                        </div>
                    </div>
                </div>

                <button onclick="nextStep(3)"
                    class="w-full bg-gradient-to-r from-purple-500 to-cyan-500 text-black font-black py-4 rounded-xl transition-all hover:scale-[1.02] active:scale-95">
                    ä¸‹ä¸€é¡¹ â†’
                </button>
            </div>

            <!-- Step 3: Visual Span (Schulte) -->
            <div class="step glass-panel rounded-3xl p-8 hidden" id="step-3">
                <div class="text-center mb-6">
                    <div
                        class="inline-block px-3 py-1 bg-green-500/20 text-green-400 text-xs font-bold rounded-full mb-4">
                        ç¬¬ä¸‰é¡¹ / å…±å››é¡¹
                    </div>
                    <h2 class="text-xl font-bold text-white mb-2">ğŸ¯ è§†è§‰å¹¿åº¦æµ‹è¯•</h2>
                    <p class="text-zinc-500 text-sm">æµ‹è¯•"ä¸€ç›®åè¡Œ"çš„èƒ½åŠ›</p>
                </div>

                <div class="glass-panel rounded-2xl p-4 mb-6 border-l-4 border-green-500">
                    <p class="text-sm text-zinc-400">
                        è®©å­©å­æŒ‰é¡ºåºä» <strong class="text-green-400">1 ç‚¹åˆ° 25</strong>ï¼Œè®¡æ—¶å¼€å§‹åç‚¹å‡»æ•°å­—ã€‚
                    </p>
                </div>

                <!-- Timer Display -->
                <div class="text-center mb-6">
                    <p class="text-xs text-zinc-500 uppercase tracking-widest mb-1">ç”¨æ—¶</p>
                    <p class="tech-font text-4xl text-cyan-400" id="schulte-timer">0.0</p>
                    <p class="text-sm text-zinc-500 mt-2">ä¸‹ä¸€ä¸ªæ•°å­—: <span id="next-number"
                            class="text-white font-bold">1</span></p>
                </div>

                <!-- Schulte Grid -->
                <div class="schulte-grid mb-6" id="schulte-grid">
                    <!-- Generated by JS -->
                </div>

                <!-- Reference -->
                <div class="grid grid-cols-3 gap-2 text-center text-xs mb-6">
                    <div class="glass-panel rounded-lg p-3">
                        <p class="text-green-400 font-bold">
                            < 20ç§’</p>
                                <p class="text-zinc-500">ç‹ç‰Œé£è¡Œå‘˜</p>
                    </div>
                    <div class="glass-panel rounded-lg p-3">
                        <p class="text-yellow-400 font-bold">25-35ç§’</p>
                        <p class="text-zinc-500">åˆæ ¼æˆ˜å£«</p>
                    </div>
                    <div class="glass-panel rounded-lg p-3">
                        <p class="text-red-400 font-bold">> 40ç§’</p>
                        <p class="text-zinc-500">éœ€è¦ç»´ä¿®</p>
                    </div>
                </div>

                <button onclick="startSchulte()" id="schulte-start-btn"
                    class="w-full bg-gradient-to-r from-green-500 to-cyan-500 text-black font-black py-4 rounded-xl transition-all hover:scale-[1.02] active:scale-95">
                    ğŸ å¼€å§‹è®¡æ—¶
                </button>
                <button onclick="nextStep(4)" id="schulte-next-btn"
                    class="w-full bg-gradient-to-r from-green-500 to-cyan-500 text-black font-black py-4 rounded-xl transition-all hover:scale-[1.02] active:scale-95 hidden mt-4">
                    ä¸‹ä¸€é¡¹ â†’
                </button>
            </div>

            <!-- Step 4: Visual Noise (Find 8s) -->
            <div class="step glass-panel rounded-3xl p-8 hidden" id="step-4">
                <div class="text-center mb-6">
                    <div
                        class="inline-block px-3 py-1 bg-orange-500/20 text-orange-400 text-xs font-bold rounded-full mb-4">
                        ç¬¬å››é¡¹ / å…±å››é¡¹
                    </div>
                    <h2 class="text-xl font-bold text-white mb-2">ğŸ” è§†è§‰ä¿¡å™ªæ¯”æµ‹è¯•</h2>
                    <p class="text-zinc-500 text-sm">æµ‹è¯•"æŠ—å¹²æ‰°"çš„èƒ½åŠ›</p>
                </div>

                <div class="glass-panel rounded-2xl p-4 mb-6 border-l-4 border-orange-500">
                    <p class="text-sm text-zinc-400">
                        åœ¨ä¸‹æ–¹ä¹±ç å›¾ä¸­ï¼Œæ‰¾å‡ºå¹¶ç‚¹å‡»æ‰€æœ‰çš„æ•°å­— <strong class="text-orange-400 text-xl">"8"</strong>ï¼ˆå…±<span
                            id="total-eights">?</span>ä¸ªï¼‰
                    </p>
                </div>

                <!-- Timer and Progress -->
                <div class="flex justify-between items-center mb-4">
                    <div>
                        <p class="text-xs text-zinc-500">å·²æ‰¾åˆ°</p>
                        <p class="text-lg font-bold text-green-400"><span id="found-count">0</span> / <span
                                id="total-count">?</span></p>
                    </div>
                    <div class="text-right">
                        <p class="text-xs text-zinc-500">ç”¨æ—¶</p>
                        <p class="tech-font text-lg text-cyan-400" id="noise-timer">0.0</p>
                    </div>
                </div>

                <!-- Noise Grid -->
                <div class="noise-grid mb-6" id="noise-grid">
                    <!-- Generated by JS -->
                </div>

                <button onclick="startNoiseTest()" id="noise-start-btn"
                    class="w-full bg-gradient-to-r from-orange-500 to-red-500 text-black font-black py-4 rounded-xl transition-all hover:scale-[1.02] active:scale-95">
                    ğŸ” å¼€å§‹æ‰¾"8"
                </button>
                <button onclick="generateReport()" id="noise-next-btn"
                    class="w-full bg-gradient-to-r from-orange-500 to-red-500 text-black font-black py-4 rounded-xl transition-all hover:scale-[1.02] active:scale-95 hidden mt-4">
                    ğŸ“Š ç”Ÿæˆè¯Šæ–­æŠ¥å‘Š
                </button>
            </div>

            <!-- Step 5: Report -->
            <div class="step glass-panel rounded-3xl p-8 hidden" id="step-5">
                <div class="text-center mb-6">
                    <div
                        class="inline-block px-3 py-1 bg-gradient-to-r from-cyan-500 to-green-500 text-black text-xs font-bold rounded-full mb-4">
                        ğŸ“‹ è¯Šæ–­æŠ¥å‘Š
                    </div>
                    <h2 class="text-xl font-bold text-white mb-2">è„‘è§†è§‰é›·è¾¾ä½“æ£€æŠ¥å‘Š</h2>
                    <p class="text-zinc-500 text-sm" id="report-child-info">--</p>
                </div>

                <!-- Radar Chart -->
                <div class="flex justify-center mb-6">
                    <div class="w-64 h-64">
                        <canvas id="radar-chart"></canvas>
                    </div>
                </div>

                <!-- Total Score -->
                <div class="text-center mb-6">
                    <p class="text-xs text-zinc-500 uppercase tracking-widest mb-2">è§†è§‰ç³»ç»Ÿæ€»è¯„åˆ†</p>
                    <p class="tech-font text-6xl font-bold" id="total-score-display">--</p>
                    <p class="text-sm mt-2" id="score-level">--</p>
                </div>

                <!-- Detailed Scores -->
                <div class="grid grid-cols-2 gap-3 mb-6">
                    <div class="glass-panel rounded-xl p-4 text-center">
                        <p class="text-xs text-zinc-500 mb-1">çœ¼åŠ¨æ§åˆ¶åŠ›</p>
                        <p class="text-xl font-bold" id="score-part1">--</p>
                    </div>
                    <div class="glass-panel rounded-xl p-4 text-center">
                        <p class="text-xs text-zinc-500 mb-1">èåˆè°ƒèŠ‚åŠ›</p>
                        <p class="text-xl font-bold" id="score-part2">--</p>
                    </div>
                    <div class="glass-panel rounded-xl p-4 text-center">
                        <p class="text-xs text-zinc-500 mb-1">è§†è§‰å¹¿åº¦</p>
                        <p class="text-xl font-bold" id="score-part3">--</p>
                    </div>
                    <div class="glass-panel rounded-xl p-4 text-center">
                        <p class="text-xs text-zinc-500 mb-1">æŠ—å¹²æ‰°èƒ½åŠ›</p>
                        <p class="text-xl font-bold" id="score-part4">--</p>
                    </div>
                </div>

                <!-- Diagnosis -->
                <div class="glass-panel rounded-2xl p-5 mb-6 border-l-4 border-red-500" id="diagnosis-box">
                    <div class="flex items-start gap-3">
                        <span class="text-2xl">ğŸ’€</span>
                        <div>
                            <p class="text-sm font-bold text-red-400 mb-2">è¿é•¿è¯Šæ–­</p>
                            <p class="text-sm text-zinc-300" id="diagnosis-text">--</p>
                        </div>
                    </div>
                </div>

                <!-- Prescription -->
                <div class="glass-panel rounded-2xl p-5 mb-8 border-l-4 border-green-500">
                    <div class="flex items-start gap-3">
                        <span class="text-2xl">ğŸ’Š</span>
                        <div>
                            <p class="text-sm font-bold text-green-400 mb-2">æ¨èå¤„æ–¹</p>
                            <p class="text-sm text-zinc-300" id="prescription-text">--</p>
                        </div>
                    </div>
                </div>

                <!-- CTA -->
                <div class="text-center">
                    <p class="text-xs text-zinc-500 mb-4">æŠ¥å‘Šå·²ä¿å­˜ï¼Œç¨åä¼šæœ‰ä¸“ä¸šè€å¸ˆè”ç³»æ‚¨</p>
                    <a href="index.html"
                        class="block w-full bg-gradient-to-r from-green-500 to-cyan-500 text-black font-black py-4 rounded-xl transition-all hover:scale-[1.02] active:scale-95 text-center">
                        ğŸ  è¿”å›é¦–é¡µ
                    </a>
                </div>
            </div>

        </div>
    </div>

    <script>
        // Supabase Config
        const SUPABASE_URL = 'https://oqwqlrmqblguiikrsmjf.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9xd3Fscm1xYmxndWlpa3JzbWpmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgxMzcwMDUsImV4cCI6MjA4MzcxMzAwNX0.JlVesN-orDXZa5skq_WmKcVTlLP_HKMq2GKWwfuMoTA';

        // Assessment Data
        let assessmentData = {
            phone: '',
            child_name: '',
            child_age: 0,
            part1_answers: [],
            part2_answers: [],
            part3_time: 0,
            part4_found: 0,
            part4_total: 0,
            part4_time: 0
        };

        let currentStep = 0;
        let schulteTimer = null;
        let schulteStartTime = 0;
        let schulteCurrentNumber = 1;
        let noiseTimer = null;
        let noiseStartTime = 0;
        let noiseEights = [];
        let foundEights = 0;

        // Toggle option selection
        function toggleOption(card, part) {
            const isGood = card.dataset.good === 'true';

            if (card.classList.contains('selected') || card.classList.contains('selected-good')) {
                card.classList.remove('selected', 'selected-good');
                card.querySelector('.check-box').style.borderColor = '#52525b';
                card.querySelector('.check-box').style.background = 'transparent';
                card.querySelector('.check-box').style.color = 'transparent';
            } else {
                card.classList.add(isGood ? 'selected-good' : 'selected');
                card.querySelector('.check-box').style.borderColor = isGood ? '#10b981' : '#ef4444';
                card.querySelector('.check-box').style.background = isGood ? '#10b981' : '#ef4444';
                card.querySelector('.check-box').style.color = 'white';
            }
        }

        // Get selected options for a part
        function getSelectedOptions(partId) {
            const container = document.getElementById(`${partId}-options`);
            const selected = container.querySelectorAll('.selected, .selected-good');
            return Array.from(selected).map(el => parseInt(el.dataset.value));
        }

        // Navigate to next step
        function nextStep(step) {
            // Save current step data
            if (currentStep === 1) {
                assessmentData.part1_answers = getSelectedOptions('part1');
            } else if (currentStep === 2) {
                assessmentData.part2_answers = getSelectedOptions('part2');
            }

            // Hide current step
            document.getElementById(`step-${currentStep}`).classList.add('hidden');

            // Show next step
            currentStep = step;
            const nextEl = document.getElementById(`step-${step}`);
            nextEl.classList.remove('hidden');
            nextEl.classList.add('slide-in');

            // Update progress bar
            updateProgress();

            // Initialize step-specific content
            if (step === 3) {
                initSchulte();
            } else if (step === 4) {
                initNoiseTest();
            }
        }

        // Update progress indicator
        function updateProgress() {
            document.querySelectorAll('.step-indicator').forEach((el, idx) => {
                el.classList.remove('active', 'completed');
                if (idx < currentStep) {
                    el.classList.add('completed');
                } else if (idx === currentStep) {
                    el.classList.add('active');
                }
            });
        }

        // Start test
        function startTest() {
            const phone = document.getElementById('input-phone').value.trim();
            const name = document.getElementById('input-name').value.trim();
            const age = parseInt(document.getElementById('input-age').value);

            if (!phone || phone.length < 11) {
                alert('è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·');
                return;
            }
            if (!name) {
                alert('è¯·è¾“å…¥å­©å­å§“å');
                return;
            }
            if (!age || age < 6 || age > 15) {
                alert('è¯·è¾“å…¥æ­£ç¡®çš„å¹´é¾„ï¼ˆ6-15å²ï¼‰');
                return;
            }

            assessmentData.phone = phone;
            assessmentData.child_name = name;
            assessmentData.child_age = age;

            nextStep(1);
        }

        // Schulte Grid Functions
        function initSchulte() {
            const grid = document.getElementById('schulte-grid');
            grid.innerHTML = '';

            // Generate shuffled numbers 1-25
            const numbers = Array.from({ length: 25 }, (_, i) => i + 1);
            for (let i = numbers.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [numbers[i], numbers[j]] = [numbers[j], numbers[i]];
            }

            numbers.forEach(num => {
                const cell = document.createElement('div');
                cell.className = 'schulte-cell';
                cell.textContent = num;
                cell.dataset.num = num;
                cell.onclick = () => clickSchulteCell(cell);
                grid.appendChild(cell);
            });

            schulteCurrentNumber = 1;
            document.getElementById('next-number').textContent = '1';
            document.getElementById('schulte-timer').textContent = '0.0';
        }

        function startSchulte() {
            document.getElementById('schulte-start-btn').classList.add('hidden');
            schulteStartTime = Date.now();
            schulteTimer = setInterval(() => {
                const elapsed = (Date.now() - schulteStartTime) / 1000;
                document.getElementById('schulte-timer').textContent = elapsed.toFixed(1);
            }, 100);
        }

        function clickSchulteCell(cell) {
            if (!schulteTimer) return;

            const num = parseInt(cell.dataset.num);
            if (num === schulteCurrentNumber) {
                cell.classList.add('correct');
                schulteCurrentNumber++;
                document.getElementById('next-number').textContent = schulteCurrentNumber <= 25 ? schulteCurrentNumber : 'âœ“';

                if (schulteCurrentNumber > 25) {
                    // Complete!
                    clearInterval(schulteTimer);
                    const elapsed = (Date.now() - schulteStartTime) / 1000;
                    assessmentData.part3_time = elapsed;
                    document.getElementById('schulte-next-btn').classList.remove('hidden');
                }
            } else {
                cell.classList.add('wrong');
                setTimeout(() => cell.classList.remove('wrong'), 300);
            }
        }

        // Noise Test Functions
        function initNoiseTest() {
            const grid = document.getElementById('noise-grid');
            grid.innerHTML = '';
            noiseEights = [];
            foundEights = 0;

            // Characters to use (confusable with 8)
            const chars = '0369BODS23568901234567890ABCDEFG';
            const totalCells = 80; // 8 rows x 10 cols
            const numEights = 8 + Math.floor(Math.random() * 5); // 8-12 eights

            // Randomly place 8s
            const eightPositions = new Set();
            while (eightPositions.size < numEights) {
                eightPositions.add(Math.floor(Math.random() * totalCells));
            }

            for (let i = 0; i < totalCells; i++) {
                const cell = document.createElement('div');
                cell.className = 'noise-cell';

                if (eightPositions.has(i)) {
                    cell.textContent = '8';
                    cell.dataset.isEight = 'true';
                    noiseEights.push(i);
                } else {
                    cell.textContent = chars[Math.floor(Math.random() * chars.length)];
                }

                cell.onclick = () => clickNoiseCell(cell, i);
                grid.appendChild(cell);
            }

            document.getElementById('total-eights').textContent = numEights;
            document.getElementById('total-count').textContent = numEights;
            document.getElementById('found-count').textContent = '0';
            assessmentData.part4_total = numEights;
        }

        function startNoiseTest() {
            document.getElementById('noise-start-btn').classList.add('hidden');
            noiseStartTime = Date.now();
            noiseTimer = setInterval(() => {
                const elapsed = (Date.now() - noiseStartTime) / 1000;
                document.getElementById('noise-timer').textContent = elapsed.toFixed(1);
            }, 100);
        }

        function clickNoiseCell(cell, idx) {
            if (!noiseTimer) return;
            if (cell.classList.contains('found')) return;

            if (cell.dataset.isEight === 'true') {
                cell.classList.add('found');
                foundEights++;
                document.getElementById('found-count').textContent = foundEights;

                if (foundEights >= noiseEights.length) {
                    clearInterval(noiseTimer);
                    const elapsed = (Date.now() - noiseStartTime) / 1000;
                    assessmentData.part4_time = elapsed;
                    assessmentData.part4_found = foundEights;
                    document.getElementById('noise-next-btn').classList.remove('hidden');
                }
            }
        }

        // Generate Report
        async function generateReport() {
            // Calculate scores
            const scores = calculateScores();

            // Save to database
            await saveAssessment(scores);

            // Show report
            nextStep(5);
            renderReport(scores);
        }

        function calculateScores() {
            // Part 1: Eye Tracking (100 if only option 0 selected, -25 for each bad option)
            let part1Score = 100;
            if (!assessmentData.part1_answers.includes(0)) part1Score -= 40;
            if (assessmentData.part1_answers.includes(1)) part1Score -= 20;
            if (assessmentData.part1_answers.includes(2)) part1Score -= 25;
            if (assessmentData.part1_answers.includes(3)) part1Score -= 15;
            part1Score = Math.max(0, part1Score);

            // Part 2: Binocular Fusion
            let part2Score = 100;
            if (!assessmentData.part2_answers.includes(0)) part2Score -= 40;
            if (assessmentData.part2_answers.includes(1)) part2Score -= 25;
            if (assessmentData.part2_answers.includes(2)) part2Score -= 20;
            if (assessmentData.part2_answers.includes(3)) part2Score -= 15;
            part2Score = Math.max(0, part2Score);

            // Part 3: Visual Span (based on time)
            let part3Score = 100;
            const time = assessmentData.part3_time;
            if (time <= 20) part3Score = 100;
            else if (time <= 25) part3Score = 85;
            else if (time <= 35) part3Score = 65;
            else if (time <= 40) part3Score = 45;
            else part3Score = Math.max(20, 100 - time);

            // Part 4: Noise (accuracy + time)
            let part4Score = 100;
            const accuracy = assessmentData.part4_found / assessmentData.part4_total;
            part4Score = Math.round(accuracy * 100);
            if (assessmentData.part4_time > 30) part4Score -= 10;
            if (assessmentData.part4_time > 45) part4Score -= 10;
            part4Score = Math.max(0, part4Score);

            // Total weighted score
            const total = Math.round((part1Score + part2Score + part3Score + part4Score) / 4);

            return {
                part1: part1Score,
                part2: part2Score,
                part3: part3Score,
                part4: part4Score,
                total: total
            };
        }

        function renderReport(scores) {
            // Child info
            document.getElementById('report-child-info').textContent =
                `${assessmentData.child_name}ï¼ˆ${assessmentData.child_age}å²ï¼‰| ${assessmentData.phone}`;

            // Individual scores
            const scoreColor = (s) => s >= 70 ? 'text-green-400' : s >= 50 ? 'text-yellow-400' : 'text-red-400';
            document.getElementById('score-part1').className = `text-xl font-bold ${scoreColor(scores.part1)}`;
            document.getElementById('score-part1').textContent = scores.part1 + 'åˆ†';
            document.getElementById('score-part2').className = `text-xl font-bold ${scoreColor(scores.part2)}`;
            document.getElementById('score-part2').textContent = scores.part2 + 'åˆ†';
            document.getElementById('score-part3').className = `text-xl font-bold ${scoreColor(scores.part3)}`;
            document.getElementById('score-part3').textContent = scores.part3 + 'åˆ†';
            document.getElementById('score-part4').className = `text-xl font-bold ${scoreColor(scores.part4)}`;
            document.getElementById('score-part4').textContent = scores.part4 + 'åˆ†';

            // Total score
            document.getElementById('total-score-display').className = `tech-font text-6xl font-bold ${scoreColor(scores.total)}`;
            document.getElementById('total-score-display').textContent = scores.total;

            let levelText = '';
            if (scores.total >= 80) levelText = '<span class="text-green-400">ä¼˜ç§€ - è§†è§‰ç³»ç»Ÿè¿è½¬è‰¯å¥½</span>';
            else if (scores.total >= 60) levelText = '<span class="text-yellow-400">ä¸­ç­‰ - éœ€è¦é’ˆå¯¹æ€§è®­ç»ƒ</span>';
            else levelText = '<span class="text-red-400">è­¦å‘Š - è§†è§‰ç³»ç»Ÿæ€¥éœ€ç»´ä¿®ï¼</span>';
            document.getElementById('score-level').innerHTML = levelText;

            // Diagnosis
            let diagnosis = `å®¶é•¿ï¼Œç»è¿‡æµ‹è¯•ï¼Œ${assessmentData.child_name}çš„çœ¼ç›ï¼ˆç¡¬ä»¶ï¼‰æ˜¯å¥½çš„ï¼Œè§†åŠ›è¡¨èƒ½çœ‹æ¸…ã€‚ä½†æ˜¯ï¼ä»–çš„å¤§è„‘è§†è§‰å¤„ç†ç³»ç»Ÿï¼ˆè½¯ä»¶ï¼‰åªæœ‰ ${scores.total} åˆ†ï¼`;

            if (scores.part1 < 60) diagnosis += ' çœ¼åŠ¨æ§åˆ¶åŠ›ä¸¥é‡ä¸è¶³ï¼Œç›¸å½“äº5å²æ°´å¹³ã€‚';
            if (scores.part2 < 60) diagnosis += ' åŒçœ¼èåˆèƒ½åŠ›å·®ï¼Œå¤§è„‘æŒ‡æŒ¥ä¸åŠ¨çœ¼éƒ¨è‚Œè‚‰ã€‚';
            if (scores.part3 < 60) diagnosis += ' è§†è§‰å¹¿åº¦ä¸¥é‡æ»åï¼Œé˜…è¯»æ•ˆç‡ä½ã€‚';
            if (scores.part4 < 60) diagnosis += ' è§†è§‰æŠ—å¹²æ‰°èƒ½åŠ›å¼±ï¼Œå®¹æ˜“èµ°ç¥ã€‚';

            diagnosis += ' è¿™å°±æ˜¯ä»–è¡¥è¯¾æ²¡ç”¨ã€å†™ä½œä¸šç£¨è¹­çš„æ ¹æœ¬åŸå› ï¼è¿™å°"æœºå™¨"å¦‚æœä¸ä¿®ï¼Œå¾€é‡Œé¢çŒå†å¤šçŸ¥è¯†ä¹Ÿæ˜¯æ¼çš„ï¼';
            document.getElementById('diagnosis-text').textContent = diagnosis;

            // Prescription
            let prescription = 'å»ºè®®å‚åŠ  2980 å…ƒã€Šè„‘è§†è§‰ç‰¹è®­è¥ã€‹ï¼š';
            if (scores.part1 < 70 || scores.part3 < 70) prescription += 'ã€èˆ’å°”ç‰¹æ–¹æ ¼ç‰¹è®­ã€‘';
            if (scores.part2 < 70) prescription += 'ã€ç¿»è½¬æ‹+èšæ•£çƒç‰©ç†æ·±è¹²ã€‘';
            if (scores.part4 < 70) prescription += 'ã€Gaboré˜ˆå€¼è¾¹ç¼˜è®­ç»ƒã€‘';
            document.getElementById('prescription-text').textContent = prescription;

            // Radar Chart
            const ctx = document.getElementById('radar-chart').getContext('2d');
            new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['çœ¼åŠ¨æ§åˆ¶åŠ›', 'èåˆè°ƒèŠ‚åŠ›', 'è§†è§‰å¹¿åº¦', 'æŠ—å¹²æ‰°èƒ½åŠ›'],
                    datasets: [{
                        label: 'å¾—åˆ†',
                        data: [scores.part1, scores.part2, scores.part3, scores.part4],
                        backgroundColor: 'rgba(6, 182, 212, 0.2)',
                        borderColor: 'rgba(6, 182, 212, 1)',
                        borderWidth: 2,
                        pointBackgroundColor: 'rgba(6, 182, 212, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(6, 182, 212, 1)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                stepSize: 25,
                                color: '#71717a',
                                backdropColor: 'transparent'
                            },
                            grid: {
                                color: 'rgba(255,255,255,0.1)'
                            },
                            angleLines: {
                                color: 'rgba(255,255,255,0.1)'
                            },
                            pointLabels: {
                                color: '#a1a1aa',
                                font: { size: 11 }
                            }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        async function saveAssessment(scores) {
            try {
                const payload = {
                    phone: assessmentData.phone,
                    child_name: assessmentData.child_name,
                    child_age: assessmentData.child_age,
                    part1_score: scores.part1,
                    part1_answers: assessmentData.part1_answers,
                    part2_score: scores.part2,
                    part2_answers: assessmentData.part2_answers,
                    part3_score: scores.part3,
                    part3_time: assessmentData.part3_time,
                    part4_score: scores.part4,
                    part4_found: assessmentData.part4_found,
                    part4_total: assessmentData.part4_total,
                    part4_time: assessmentData.part4_time,
                    total_score: scores.total
                };

                const res = await fetch(`${SUPABASE_URL}/rest/v1/vision_assessments`, {
                    method: 'POST',
                    headers: {
                        'apikey': SUPABASE_KEY,
                        'Authorization': 'Bearer ' + SUPABASE_KEY,
                        'Content-Type': 'application/json',
                        'Prefer': 'return=minimal'
                    },
                    body: JSON.stringify(payload)
                });

                if (!res.ok) {
                    console.error('Save failed:', await res.text());
                } else {
                    console.log('Assessment saved successfully');
                }
            } catch (e) {
                console.error('Save error:', e);
            }
        }

        // Initialize
        updateProgress();
    </script>
</body>

</html>