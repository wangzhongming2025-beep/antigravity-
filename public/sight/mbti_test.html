<!DOCTYPE html>
<html lang="zh-CN" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MBTI èŒä¸šæ€§æ ¼æµ‹è¯• | æ·±åº¦è§£æ</title>
    <meta name="description" content="åŸºäºè£æ ¼å¿ƒç†å­¦ç†è®ºçš„MBTIæ€§æ ¼æµ‹è¯•ï¼Œæ¢ç´¢æ‚¨çš„æ€§æ ¼ç±»å‹ï¼Œå‘ç°èŒä¸šæ½œèƒ½ã€‚ä¸“ä¸šã€å…è´¹ã€æ·±åº¦è§£æã€‚">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "PingFang SC", "Microsoft YaHei", sans-serif;
        }

        body {
            background: linear-gradient(160deg, #0a0f1a 0%, #0d1520 50%, #0a0f1a 100%);
            min-height: 100vh;
            color: #f1f5f9;
        }

        .glass-card {
            background: rgba(15, 23, 42, 0.7);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(100, 116, 139, 0.2);
        }

        .btn-hover {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .btn-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px -10px rgba(14, 165, 233, 0.5);
        }

        .option-btn {
            transition: all 0.2s ease;
        }

        .option-btn:hover {
            background-color: rgba(56, 189, 248, 0.1);
            border-color: rgba(56, 189, 248, 0.5);
        }

        .option-btn.selected {
            background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
            border-color: #0ea5e9;
            color: white;
            box-shadow: 0 0 20px rgba(14, 165, 233, 0.3);
        }

        /* Animated background blob */
        .blob {
            position: absolute;
            filter: blur(80px);
            opacity: 0.4;
            z-index: -1;
        }

        .blob-1 {
            top: 0;
            left: 0;
            width: 300px;
            height: 300px;
            background: #0ea5e9;
            animation: moveBlob1 10s infinite alternate;
        }

        .blob-2 {
            bottom: 0;
            right: 0;
            width: 300px;
            height: 300px;
            background: #8b5cf6;
            animation: moveBlob2 12s infinite alternate;
        }

        @keyframes moveBlob1 {
            from {
                transform: translate(-20%, -20%);
            }

            to {
                transform: translate(10%, 10%);
            }
        }

        @keyframes moveBlob2 {
            from {
                transform: translate(20%, 20%);
            }

            to {
                transform: translate(-10%, -10%);
            }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-out forwards;
            opacity: 0;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>

<body class="overflow-x-hidden relative">

    <!-- Background Ambience -->
    <div class="blob blob-1"></div>
    <div class="blob blob-2"></div>

    <!-- Header -->
    <nav class="fixed top-0 w-full z-50 glass-card border-b-0 border-b-white/5">
        <div class="max-w-7xl mx-auto px-6 h-16 flex items-center justify-between">
            <div class="flex items-center gap-2 cursor-pointer" onclick="window.location.href='index.html'">
                <div
                    class="w-8 h-8 rounded-lg bg-gradient-to-br from-cyan-400 to-purple-600 flex items-center justify-center font-bold text-white text-sm">
                    V</div>
                <span class="font-bold text-lg tracking-tight text-white">VisionGuard</span>
            </div>
            <div class="flex items-center gap-4">
                <a href="index.html" class="text-sm text-slate-400 hover:text-white transition-colors">è¿”å›é¦–é¡µ</a>
            </div>
        </div>
    </nav>

    <main class="pt-24 pb-12 px-6 min-h-screen flex items-center justify-center">
        <div class="max-w-3xl w-full mx-auto relative z-10">

            <!-- SCREEN: START -->
            <div id="screen-start" class="text-center fade-in">
                <div
                    class="inline-flex items-center justify-center w-20 h-20 rounded-3xl bg-gradient-to-tr from-purple-500 to-indigo-500 mb-8 shadow-2xl shadow-purple-500/20">
                    <span class="text-4xl">ğŸ”®</span>
                </div>
                <h1
                    class="text-4xl md:text-5xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-cyan-400 to-purple-400 mb-6">
                    MBTI æ€§æ ¼ç±»å‹æµ‹è¯•
                </h1>
                <p class="text-lg text-slate-400 mb-10 max-w-xl mx-auto leading-relaxed">
                    åŸºäºè£æ ¼å¿ƒç†å­¦ç†è®ºï¼Œé€šè¿‡ 4 ä¸ªç»´åº¦è§£æ„æ‚¨çš„æ€§æ ¼å¯†ç ã€‚<br>
                    <span class="text-slate-500 text-sm mt-2 block">ä¸ä»…æ˜¯ä¸€ä¸ªæ ‡ç­¾ï¼Œæ›´æ˜¯äº†è§£è‡ªæˆ‘çš„å¼€å§‹ã€‚</span>
                </p>

                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-12 max-w-2xl mx-auto">
                    <div class="glass-card p-4 rounded-xl text-center">
                        <div class="text-cyan-400 font-bold text-xl mb-1">E / I</div>
                        <div class="text-xs text-slate-500">èƒ½é‡æ¥æº</div>
                    </div>
                    <div class="glass-card p-4 rounded-xl text-center">
                        <div class="text-purple-400 font-bold text-xl mb-1">S / N</div>
                        <div class="text-xs text-slate-500">æ„ŸçŸ¥æ–¹å¼</div>
                    </div>
                    <div class="glass-card p-4 rounded-xl text-center">
                        <div class="text-pink-400 font-bold text-xl mb-1">T / F</div>
                        <div class="text-xs text-slate-500">åˆ¤æ–­å†³ç­–</div>
                    </div>
                    <div class="glass-card p-4 rounded-xl text-center">
                        <div class="text-emerald-400 font-bold text-xl mb-1">J / P</div>
                        <div class="text-xs text-slate-500">ç”Ÿæ´»æ€åº¦</div>
                    </div>
                </div>

                <button onclick="startTest()"
                    class="btn-hover bg-white text-slate-900 font-bold px-10 py-4 rounded-full text-lg shadow-xl shadow-white/10 group flex items-center gap-2 mx-auto">
                    å¼€å§‹æ¢ç´¢
                    <svg xmlns="http://www.w3.org/2000/svg"
                        class="h-5 w-5 group-hover:translate-x-1 transition-transform" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M13 7l5 5m0 0l-5 5m5-5H6" />
                    </svg>
                </button>
                <p class="text-xs text-slate-600 mt-6">å…± 28 é¢˜ Â· çº¦ 5 åˆ†é’Ÿ</p>
            </div>

            <!-- SCREEN: TEST -->
            <div id="screen-test" class="hidden fade-in">
                <!-- Progress -->
                <div class="mb-8">
                    <div class="flex justify-between items-end mb-2">
                        <span class="text-2xl font-bold text-white"><span id="current-q">1</span><span
                                class="text-lg text-slate-600 font-normal"> / <span id="total-q">28</span></span></span>
                        <span class="text-xs text-slate-500 uppercase tracking-wider font-medium"
                            id="dimension-tag">èƒ½é‡æ¥æº</span>
                    </div>
                    <div class="h-1.5 w-full bg-slate-800 rounded-full overflow-hidden">
                        <div id="progress-bar"
                            class="h-full bg-gradient-to-r from-cyan-400 to-purple-500 transition-all duration-500 ease-out"
                            style="width: 0%"></div>
                    </div>
                </div>

                <!-- Card -->
                <div
                    class="glass-card p-8 md:p-12 rounded-3xl min-h-[400px] flex flex-col justify-center relative overlow-hidden">
                    <div
                        class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-white/10 to-transparent">
                    </div>

                    <h2 id="question-text"
                        class="text-2xl md:text-3xl font-medium text-center text-white mb-12 leading-relaxed">
                        åœ¨ç¤¾äº¤èšä¼šä¸Šï¼Œä½ é€šå¸¸æ›´å–œæ¬¢...
                    </h2>

                    <div class="space-y-4 max-w-xl mx-auto w-full">
                        <button onclick="answer(1)"
                            class="option-btn w-full p-5 rounded-2xl border border-slate-700 bg-slate-800/30 text-left group">
                            <div class="flex items-center justify-between">
                                <span id="option-a-text"
                                    class="text-slate-200 group-hover:text-white transition-colors text-lg">ä¸»åŠ¨ä¸ä¸åŒçš„äººäº¤è°ˆ</span>
                                <div
                                    class="w-5 h-5 rounded-full border-2 border-slate-600 group-hover:border-cyan-400 transition-colors">
                                </div>
                            </div>
                        </button>
                        <button onclick="answer(-1)"
                            class="option-btn w-full p-5 rounded-2xl border border-slate-700 bg-slate-800/30 text-left group">
                            <div class="flex items-center justify-between">
                                <span id="option-b-text"
                                    class="text-slate-200 group-hover:text-white transition-colors text-lg">åªä¸ç†Ÿæ‚‰çš„å°‘æ•°äººäº¤æµ</span>
                                <div
                                    class="w-5 h-5 rounded-full border-2 border-slate-600 group-hover:border-cyan-400 transition-colors">
                                </div>
                            </div>
                        </button>
                    </div>
                </div>

                <div class="text-center mt-6">
                    <button onclick="prevQuestion()" id="btn-prev"
                        class="text-slate-500 hover:text-slate-300 text-sm py-2 px-4 rounded-lg transition-colors disabled:opacity-0">
                        â† ä¸Šä¸€é¢˜
                    </button>
                </div>
            </div>

            <!-- SCREEN: RESULT -->
            <div id="screen-result" class="hidden fade-in">
                <div class="text-center mb-10">
                    <h2 class="text-xl text-slate-400 mb-2">æ‚¨çš„æ€§æ ¼ç±»å‹æ˜¯</h2>
                    <h1 id="result-type"
                        class="text-7xl font-black bg-clip-text text-transparent bg-gradient-to-r from-cyan-400 via-purple-400 to-pink-500 mb-4 tracking-tighter"
                        style="text-shadow: 0 0 60px rgba(139, 92, 246, 0.3);">INTJ</h1>
                    <h3 id="result-title" class="text-2xl text-white font-bold mb-6">å»ºç­‘å¸ˆ (Architect)</h3>
                    <p id="result-desc" class="text-slate-400 max-w-2xl mx-auto text-lg leading-relaxed">
                        å¯Œæœ‰æƒ³è±¡åŠ›å’Œæˆ˜ç•¥æ€§çš„æ€æƒ³å®¶ï¼Œä¸€åˆ‡çš†åœ¨è®¡åˆ’ä¹‹ä¸­ã€‚
                    </p>
                </div>

                <!-- Analysis Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-10">
                    <!-- Energy -->
                    <div class="glass-card p-6 rounded-2xl">
                        <div class="flex justify-between items-center mb-4">
                            <span class="text-slate-400 text-sm">èƒ½é‡æ¥æº</span>
                            <span class="font-mono text-cyan-400 font-bold" id="score-ei">I: 68%</span>
                        </div>
                        <div class="relative h-2 bg-slate-800 rounded-full overflow-hidden">
                            <div class="absolute top-0 left-0 h-full bg-cyan-500 transition-all duration-1000"
                                id="bar-e" style="width: 50%"></div>
                            <div class="absolute top-0 right-0 h-full bg-purple-500 transition-all duration-1000"
                                id="bar-i" style="width: 50%"></div>
                        </div>
                        <div class="flex justify-between mt-2 text-xs font-bold text-slate-500">
                            <span>å¤–å‘ (E)</span>
                            <span>å†…å‘ (I)</span>
                        </div>
                    </div>

                    <!-- Info -->
                    <div class="glass-card p-6 rounded-2xl">
                        <div class="flex justify-between items-center mb-4">
                            <span class="text-slate-400 text-sm">ä¿¡æ¯è·å–</span>
                            <span class="font-mono text-purple-400 font-bold" id="score-sn">N: 72%</span>
                        </div>
                        <div class="relative h-2 bg-slate-800 rounded-full overflow-hidden">
                            <div class="absolute top-0 left-0 h-full bg-cyan-500 transition-all duration-1000"
                                id="bar-s" style="width: 50%"></div>
                            <div class="absolute top-0 right-0 h-full bg-purple-500 transition-all duration-1000"
                                id="bar-n" style="width: 50%"></div>
                        </div>
                        <div class="flex justify-between mt-2 text-xs font-bold text-slate-500">
                            <span>å®æ„Ÿ (S)</span>
                            <span>ç›´è§‰ (N)</span>
                        </div>
                    </div>

                    <!-- Decision -->
                    <div class="glass-card p-6 rounded-2xl">
                        <div class="flex justify-between items-center mb-4">
                            <span class="text-slate-400 text-sm">å†³ç­–æ–¹å¼</span>
                            <span class="font-mono text-pink-400 font-bold" id="score-tf">T: 85%</span>
                        </div>
                        <div class="relative h-2 bg-slate-800 rounded-full overflow-hidden">
                            <div class="absolute top-0 left-0 h-full bg-cyan-500 transition-all duration-1000"
                                id="bar-t" style="width: 50%"></div>
                            <div class="absolute top-0 right-0 h-full bg-purple-500 transition-all duration-1000"
                                id="bar-f" style="width: 50%"></div>
                        </div>
                        <div class="flex justify-between mt-2 text-xs font-bold text-slate-500">
                            <span>ç†æ™º (T)</span>
                            <span>æƒ…æ„Ÿ (F)</span>
                        </div>
                    </div>

                    <!-- Lifestyle -->
                    <div class="glass-card p-6 rounded-2xl">
                        <div class="flex justify-between items-center mb-4">
                            <span class="text-slate-400 text-sm">ç”Ÿæ´»æ€åº¦</span>
                            <span class="font-mono text-emerald-400 font-bold" id="score-jp">J: 60%</span>
                        </div>
                        <div class="relative h-2 bg-slate-800 rounded-full overflow-hidden">
                            <div class="absolute top-0 left-0 h-full bg-cyan-500 transition-all duration-1000"
                                id="bar-j" style="width: 50%"></div>
                            <div class="absolute top-0 right-0 h-full bg-purple-500 transition-all duration-1000"
                                id="bar-p" style="width: 50%"></div>
                        </div>
                        <div class="flex justify-between mt-2 text-xs font-bold text-slate-500">
                            <span>åˆ¤æ–­ (J)</span>
                            <span>æ„ŸçŸ¥ (P)</span>
                        </div>
                    </div>
                </div>

                <div class="flex gap-4 justify-center">
                    <button onclick="location.reload()"
                        class="px-8 py-3 rounded-full border border-slate-700 text-white hover:bg-slate-800 transition-colors">
                        é‡æ–°æµ‹è¯•
                    </button>
                    <button onclick="window.location.href='index.html'"
                        class="px-8 py-3 rounded-full bg-white text-slate-900 font-bold hover:scale-105 transition-transform">
                        è¿”å›é¦–é¡µ
                    </button>
                </div>

                <!-- Pro Tip -->
                <div class="mt-12 p-6 rounded-2xl bg-white/5 border border-white/5 text-center">
                    <p class="text-slate-400 text-sm">æƒ³è·å–æ›´è¯¦ç»†çš„èŒä¸šå‘å±•å»ºè®®ä¸æ€§æ ¼ç›²ç‚¹åˆ†æï¼Ÿ</p>
                    <button onclick="alert('åŠŸèƒ½å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…ï¼')"
                        class="mt-3 text-cyan-400 text-sm hover:text-cyan-300 font-medium font-mono">
                        æŸ¥çœ‹å®Œæ•´æŠ¥å‘Š (PRO) â†’
                    </button>
                </div>
            </div>

        </div>
    </main>

    <script>
        // --- DATA ---
        // Questions: Each has a dimension (EI, SN, TF, JP) and a positive/negative weight
        // E+, I-
        // S+, N-
        // T+, F-
        // J+, P-

        const QUESTIONS = [
            // E vs I (7 questions)
            { d: 'EI', text: "åœ¨ç–²æƒ«çš„æ—¶å€™ï¼Œä½ æ›´å€¾å‘äºå¦‚ä½•æ¢å¤ç²¾åŠ›ï¼Ÿ", a: "æ‰¾æœ‹å‹èšä¼šæˆ–å‡ºå»èµ°èµ° (E)", b: "ç‹¬è‡ªä¸€äººåœ¨å®‰é™çš„ç¯å¢ƒä¸­ä¼‘æ¯ (I)", w: 1 },
            { d: 'EI', text: "åœ¨æ–°çš„ç¤¾äº¤åœˆå­é‡Œï¼Œä½ é€šå¸¸æ˜¯...", a: "ä¸»åŠ¨ä»‹ç»è‡ªå·±ï¼Œå¾ˆå®¹æ˜“è®¤è¯†æ–°æœ‹å‹ (E)", b: "ç­‰å¾…åˆ«äººæ¥ä»‹ç»ï¼Œæ¯”è¾ƒæ…¢çƒ­ (I)", w: 1 },
            { d: 'EI', text: "ä½ æ›´å–œæ¬¢å“ªç§å·¥ä½œç¯å¢ƒï¼Ÿ", a: "å¼€æ”¾å¼ã€ç»å¸¸ä¸äººè®¨è®ºäº¤æµçš„ (E)", b: "ç‹¬ç«‹ã€å®‰é™ã€å¯ä»¥ä¸“æ³¨æ€è€ƒçš„ (I)", w: 1 },
            { d: 'EI', text: "é‡åˆ°é—®é¢˜æ—¶ï¼Œä½ ä¹ æƒ¯...", a: "æ‰¾äººå•†é‡ï¼Œè¾¹è¯´è¾¹ç†æ¸…æ€è·¯ (E)", b: "è‡ªå·±å…ˆåœ¨è„‘å­é‡Œæƒ³æ¸…æ¥šå†è¡¨è¾¾ (I)", w: 1 },
            { d: 'EI', text: "ä½ è®¤ä¸ºè‡ªå·±æ˜¯ä¸€ä¸ª...", a: "å®¹æ˜“è¢«äº†è§£çš„äºº (E)", b: "æ·±æ²‰éš¾æ‡‚çš„äºº (I)", w: 1 },
            { d: 'EI', text: "åœ¨èšä¼šä¸Šï¼Œä½ é€šå¸¸å¾…åˆ°...", a: "å¾ˆæ™šï¼Œå¹¶ä¸”ç²¾åŠ›å……æ²› (E)", b: "æ—©æ—©ç¦»å¼€ï¼Œæˆ–è€…æ„Ÿåˆ°ç²¾ç–²åŠ›å°½ (I)", w: 1 },
            { d: 'EI', text: "ä½ æ›´å–œæ¬¢...", a: "å¹¿åº¦ï¼šè®¤è¯†å¾ˆå¤šäººï¼Œå³ä½¿äº¤æƒ…ä¸æ·± (E)", b: "æ·±åº¦ï¼šåªæœ‰å‡ ä¸ªäº²å¯†æœ‹å‹ï¼Œä½†å…³ç³»å¾ˆé“ (I)", w: 1 },

            // S vs N (7 questions)
            { d: 'SN', text: "ä½ æ›´å…³æ³¨...", a: "å½“ä¸‹çš„ç°å®å’Œå…·ä½“çš„ç»†èŠ‚ (S)", b: "æœªæ¥çš„å¯èƒ½æ€§å’Œæ½œåœ¨çš„å«ä¹‰ (N)", w: 1 },
            { d: 'SN', text: "ä½ æ˜¯å¦‚ä½•è·å–ä¿¡æ¯çš„ï¼Ÿ", a: "ç›¸ä¿¡ç¡®å‡¿çš„è¯æ®ã€æ•°æ®å’Œç»éªŒ (S)", b: "ç›¸ä¿¡ç›´è§‰ã€çµæ„Ÿå’Œç†è®ºæ¨¡å‹ (N)", w: 1 },
            { d: 'SN', text: "ä½ æ›´å–œæ¬¢å“ªç§ç±»å‹çš„æè¿°ï¼Ÿ", a: "å…·ä½“çš„ã€æŒ‰æ­¥éª¤çš„ (S)", b: "æ¯”å–»çš„ã€æ¦‚å¿µæ€§çš„ (N)", w: 1 },
            { d: 'SN', text: "åœ¨åšè®¡åˆ’æ—¶ï¼Œä½ å€¾å‘äº...", a: "å‚è€ƒè¿‡å»ç±»ä¼¼çš„ç»éªŒ (S)", b: "å°è¯•å…¨æ–°çš„ã€æœªç»éªŒè¯çš„æ–¹æ³• (N)", w: 1 },
            { d: 'SN', text: "ä½ è®¤ä¸ºè‡ªå·±æ›´åŠ¡å®è¿˜æ˜¯æ›´æœ‰æƒ³è±¡åŠ›ï¼Ÿ", a: "åŠ¡å® (S)", b: "æœ‰æƒ³è±¡åŠ› (N)", w: 1 },
            { d: 'SN', text: "ä½ æ›´æ“…é•¿...", a: "å¤„ç†å…·ä½“çš„æ—¥å¸¸äº‹åŠ¡ (S)", b: "æ„æ€å®å¤§çš„è“å›¾ (N)", w: 1 },
            { d: 'SN', text: "ä½ å¯¹äº‹ç‰©çš„çœ‹æ³•é€šå¸¸æ˜¯...", a: "è§æ ‘ (S)", b: "è§æ— (N)", w: 1 },

            // T vs F (7 questions)
            { d: 'TF', text: "åšå†³å®šæ—¶ï¼Œä½ æ›´çœ‹é‡...", a: "é€»è¾‘ã€å®¢è§‚å’Œå…¬å¹³ (T)", b: "ä»·å€¼è§‚ã€å’Œè°å’Œå¯¹ä»–äººçš„å½±å“ (F)", w: 1 },
            { d: 'TF', text: "å¦‚æœæœ‹å‹çŠ¯äº†é”™ï¼Œä½ ä¼š...", a: "ç›´ç‡åœ°æŒ‡å‡ºé—®é¢˜æ‰€åœ¨ (T)", b: "å§”å©‰åœ°è¡¨è¾¾ï¼Œç…§é¡¾å¯¹æ–¹æƒ…ç»ª (F)", w: 1 },
            { d: 'TF', text: "ä½ è®¤ä¸ºå“ªç§å“è´¨æ›´é‡è¦ï¼Ÿ", a: "åšå®šã€ç†æ™º (T)", b: "ä»æ…ˆã€ä½“è´´ (F)", w: 1 },
            { d: 'TF', text: "åœ¨äº‰è®ºä¸­ï¼Œä½ æ›´åœ¨ä¹...", a: "è°æ˜¯å¯¹çš„ï¼ˆè¿½æ±‚çœŸç†ï¼‰ (T)", b: "å¤§å®¶çš„æ„Ÿå—ï¼ˆè¿½æ±‚å’Œè°ï¼‰ (F)", w: 1 },
            { d: 'TF', text: "ä½ æ›´å®¹æ˜“è¢«ä»€ä¹ˆè¯´æœï¼Ÿ", a: "é€»è¾‘æ¨å¯¼ (T)", b: "æƒ…æ„Ÿå…±é¸£ (F)", w: 1 },
            { d: 'TF', text: "å·¥ä½œä¸­çš„ä½ æ˜¯...", a: "ä»¥ä»»åŠ¡ä¸ºå¯¼å‘ (T)", b: "ä»¥äººä¸ºå¯¼å‘ (F)", w: 1 },
            { d: 'TF', text: "ä½ é€šå¸¸è¢«è®¤ä¸º...", a: "å†·é™ç”šè‡³æœ‰ç‚¹å†·æ¼  (T)", b: "çƒ­æƒ…ä¸”å¯Œæœ‰åŒæƒ…å¿ƒ (F)", w: 1 },

            // J vs P (7 questions)
            { d: 'JP', text: "ä½ çš„ç”Ÿæ´»æ–¹å¼æ›´æ¥è¿‘...", a: "äº•äº•æœ‰æ¡ã€æœ‰è®¡åˆ’çš„ (J)", b: "éšæ€§ã€çµæ´»ã€é¡ºå…¶è‡ªç„¶çš„ (P)", w: 1 },
            { d: 'JP', text: "å¯¹äºæœ€åæœŸé™ (Deadline)ï¼Œä½ é€šå¸¸...", a: "æå‰å®Œæˆï¼Œé¿å…åŒ†å¿™ (J)", b: "åœ¨æœ€åä¸€åˆ»çˆ†å‘æƒŠäººçš„æ•ˆç‡ (P)", w: 1 },
            { d: 'JP', text: "æ—…è¡Œå‰ï¼Œä½ ä¼š...", a: "åˆ¶å®šè¯¦ç»†çš„è¡Œç¨‹è¡¨ (J)", b: "åˆ°äº†ç›®çš„åœ°å†çœ‹å¿ƒæƒ…å†³å®š (P)", w: 1 },
            { d: 'JP', text: "ä½ æ›´å–œæ¬¢...", a: "äº‹æƒ…ä¸€æ—¦å†³å®šå°±ç¡®å®šä¸‹æ¥ (J)", b: "ä¿æŒå¼€æ”¾ï¼Œç›´åˆ°æœ€åæ—¶åˆ» (P)", w: 1 },
            { d: 'JP', text: "ä½ çš„å·¥ä½œåŒºåŸŸé€šå¸¸æ˜¯...", a: "æ•´æ´æœ‰åºçš„ (J)", b: "è™½ç„¶ä¹±ä½†æ‰¾å¾—åˆ°ä¸œè¥¿çš„ (P)", w: 1 },
            { d: 'JP', text: "åœ¨å®Œæˆä»»åŠ¡æ—¶ï¼Œä½ å–œæ¬¢...", a: "å…ˆå·¥ä½œå†ç©ï¼Œå®Œæˆåæ‰æ”¾æ¾ (J)", b: "è¾¹ç©è¾¹åšï¼Œæˆ–è€…åœ¨å‹åŠ›ä¸‹å·¥ä½œ (P)", w: 1 },
            { d: 'JP', text: "ä½ æ›´çœ‹é‡...", a: "ç»“æœå’Œå®Œæˆåº¦ (J)", b: "è¿‡ç¨‹å’Œä½“éªŒ (P)", w: 1 }
        ];

        // Format questions to be cleaner for UI
        const PROCESSED_QUESTIONS = QUESTIONS.map(q => ({
            d: q.d,
            text: q.text,
            a: q.a.replace(/\s\([A-Z]\)$/, ''),
            b: q.b.replace(/\s\([A-Z]\)$/, ''),
            wa: q.w, // weight if A is chosen (Positive)
            wb: -1 * q.w // weight if B is chosen (Negative)
        }));

        // Type Descriptions
        const TYPES = {
            "ISTJ": { title: "ç‰©æµå¸ˆ (Logistician)", desc: "å®é™…ã€æ³¨é‡äº‹å®ã€‚å€¼å¾—ä¿¡èµ–çš„ç°å®ä¸»ä¹‰è€…ã€‚" },
            "ISFJ": { title: "å®ˆå«è€… (Defender)", desc: "éå¸¸ä¸“æ³¨è€Œæ¸©æš–çš„ä¿æŠ¤è€…ï¼Œæ—¶åˆ»å‡†å¤‡ç€ä¿æŠ¤çˆ±çš„ä¸€æ–¹ã€‚" },
            "INFJ": { title: "æå€¡è€… (Advocate)", desc: "å®‰é™è€Œç¥ç§˜ï¼ŒåŒæ—¶é¼“èˆäººå¿ƒä¸”ä¸çŸ¥ç–²å€¦çš„ç†æƒ³ä¸»ä¹‰è€…ã€‚" },
            "INTJ": { title: "å»ºç­‘å¸ˆ (Architect)", desc: "å¯Œæœ‰æƒ³è±¡åŠ›å’Œæˆ˜ç•¥æ€§çš„æ€æƒ³å®¶ï¼Œä¸€åˆ‡çš†åœ¨è®¡åˆ’ä¹‹ä¸­ã€‚" },
            "ISTP": { title: "é‰´èµå®¶ (Virtuoso)", desc: "å¤§èƒ†è€Œå®é™…çš„å®éªŒå®¶ï¼Œæ“…é•¿ä½¿ç”¨å„ç§å½¢å¼çš„å·¥å…·ã€‚" },
            "ISFP": { title: "æ¢é™©å®¶ (Adventurer)", desc: "çµæ´»æœ‰é­…åŠ›çš„è‰ºæœ¯å®¶ï¼Œæ—¶åˆ»å‡†å¤‡ç€æ¢ç´¢å’Œä½“éªŒæ–°é²œäº‹ç‰©ã€‚" },
            "INFP": { title: "è°ƒåœè€… (Mediator)", desc: "è¯—æ„ï¼Œå–„è‰¯çš„åˆ©ä»–ä¸»ä¹‰è€…ï¼Œæ€»æ˜¯çƒ­æƒ…åœ°ä¸ºæ­£å½“ç†ç”±æä¾›å¸®åŠ©ã€‚" },
            "INTP": { title: "é€»è¾‘å­¦å®¶ (Logician)", desc: "å…·æœ‰åˆ›é€ åŠ›çš„å‘æ˜å®¶ï¼Œå¯¹çŸ¥è¯†æœ‰ç€æ­¢ä¸ä½çš„æ¸´æœ›ã€‚" },
            "ESTP": { title: "ä¼ä¸šå®¶ (Entrepreneur)", desc: "èªæ˜ï¼Œç²¾åŠ›å……æ²›ï¼Œå–„äºæ„ŸçŸ¥èº«è¾¹çš„äº‹ç‰©ã€‚äº«å—å†’é™©ã€‚" },
            "ESFP": { title: "è¡¨æ¼”è€… (Entertainer)", desc: "è‡ªå‘çš„ï¼Œç²¾åŠ›å……æ²›è€Œçƒ­æƒ…çš„è¡¨æ¼”è€…ã€‚" },
            "ENFP": { title: "ç«é€‰è€… (Campaigner)", desc: "çƒ­æƒ…ï¼Œæœ‰åˆ›é€ åŠ›ï¼Œçˆ±ç¤¾äº¤çš„è‡ªç”±äººï¼Œæ€»èƒ½æ‰¾åˆ°ç†ç”±å¾®ç¬‘ã€‚" },
            "ENTP": { title: "è¾©è®ºå®¶ (Debater)", desc: "è¿½æ ¹ç©¶åº•ï¼Œèªæ˜å¥½å¥‡çš„æ€æƒ³è€…ï¼Œéš¾ä»¥æŠµæŒ¡æ™ºåŠ›æŒ‘æˆ˜çš„è¯±æƒ‘ã€‚" },
            "ESTJ": { title: "æ€»ç»ç† (Executive)", desc: "å‡ºè‰²çš„ç®¡ç†è€…ï¼Œåœ¨ç®¡ç†äº‹æƒ…æˆ–äººçš„æ–¹é¢æ— ä¸ä¼¦æ¯”ã€‚" },
            "ESFJ": { title: "æ‰§æ”¿å®˜ (Consul)", desc: "ææœ‰åŒæƒ…å¿ƒï¼Œçˆ±ç¤¾äº¤ï¼Œå—æ¬¢è¿çš„äººä»¬ï¼Œæ€»æ˜¯çƒ­å¿ƒæä¾›å¸®åŠ©ã€‚" },
            "ENFJ": { title: "ä¸»äººå…¬ (Protagonist)", desc: "å¯Œæœ‰é­…åŠ›ï¼Œé¼“èˆäººå¿ƒçš„é¢†å¯¼è€…ï¼Œæœ‰èƒ½åŠ›è®©äººä»¬ä¸ºä»–ç€è¿·ã€‚" },
            "ENTJ": { title: "æŒ‡æŒ¥å®˜ (Commander)", desc: "å¤§èƒ†ï¼Œå¯Œæœ‰æƒ³è±¡åŠ›ä¸”æ„å¿—å¼ºå¤§çš„é¢†å¯¼è€…ï¼Œæ€»èƒ½æ‰¾åˆ°æˆ–åˆ›é€ è§£å†³æ–¹æ³•ã€‚" }
        };

        // --- STATE ---
        let currentIdx = 0;
        let scores = { EI: 0, SN: 0, TF: 0, JP: 0 };
        // We will store actual answers to possibly allow 'back' in future, 
        // but for now simplistic accumulating score is fine for a quick MVP,
        // Actually to support 'prev', we should store history.
        let history = []; // stores { idx: 0, val: 1 }

        // --- DOM Elements ---
        const screenStart = document.getElementById('screen-start');
        const screenTest = document.getElementById('screen-test');
        const screenResult = document.getElementById('screen-result');

        const qText = document.getElementById('question-text');
        const optA = document.getElementById('option-a-text');
        const optB = document.getElementById('option-b-text');
        const qNum = document.getElementById('current-q');
        const qTotal = document.getElementById('total-q');
        const pBar = document.getElementById('progress-bar');
        const dTag = document.getElementById('dimension-tag');
        const btnPrev = document.getElementById('btn-prev');

        // --- INIT ---
        qTotal.textContent = PROCESSED_QUESTIONS.length;

        function startTest() {
            screenStart.classList.add('hidden');
            screenTest.classList.remove('hidden');
            loadQuestion(0);
        }

        function loadQuestion(idx) {
            currentIdx = idx;
            const q = PROCESSED_QUESTIONS[idx];

            qText.textContent = q.text;
            optA.textContent = q.a;
            optB.textContent = q.b;
            qNum.textContent = idx + 1;

            const progress = (idx / PROCESSED_QUESTIONS.length) * 100;
            pBar.style.width = `${progress}%`;
            btnPrev.disabled = idx === 0;
            btnPrev.style.opacity = idx === 0 ? 0 : 1;

            // Optional: Map dimension code to readable label
            let label = "";
            if (q.d === 'EI') label = "èƒ½é‡æ¥æº (E/I)";
            if (q.d === 'SN') label = "æ„ŸçŸ¥æ–¹å¼ (S/N)";
            if (q.d === 'TF') label = "åˆ¤æ–­å†³ç­– (T/F)";
            if (q.d === 'JP') label = "ç”Ÿæ´»æ€åº¦ (J/P)";
            dTag.textContent = label;
        }

        window.answer = function (val) {
            // val is 1 (A) or -1 (B)
            // Store answer
            history[currentIdx] = val;

            if (currentIdx < PROCESSED_QUESTIONS.length - 1) {
                // Next
                loadQuestion(currentIdx + 1);
            } else {
                // Finish
                calculateAndShowResult();
            }
        };

        window.prevQuestion = function () {
            if (currentIdx > 0) {
                loadQuestion(currentIdx - 1);
            }
        }

        function calculateAndShowResult() {
            // Reset scores
            scores = { EI: 0, SN: 0, TF: 0, JP: 0 };

            // Tally
            // A = +1, B = -1
            history.forEach((val, i) => {
                const dim = PROCESSED_QUESTIONS[i].d;
                scores[dim] += val; // Simple addition. E>0 means E, E<0 means I.
            });

            // Determine Type
            const type = [
                scores.EI >= 0 ? 'E' : 'I',
                scores.SN >= 0 ? 'S' : 'N',
                scores.TF >= 0 ? 'T' : 'F',
                scores.JP >= 0 ? 'J' : 'P'
            ].join('');

            // Calculate Percentages (for visualization)
            // Each dim has 7 questions. Max score +7, Min -7
            // Range 14. 
            // Percentage of dominant trait:
            // if score is 3. (3 - (-7)) / 14 = 10/14 approx 71% ? 
            // No, let's say 4 A's and 3 B's. Score = 4-3 = 1. E is dominant.
            // How strong? 4 out of 7 is 57%. 

            // Let's count specific responses for better %
            let counts = { E: 0, I: 0, S: 0, N: 0, T: 0, F: 0, J: 0, P: 0 };
            history.forEach((val, i) => {
                const dim = PROCESSED_QUESTIONS[i].d;
                if (dim === 'EI') val > 0 ? counts.E++ : counts.I++;
                if (dim === 'SN') val > 0 ? counts.S++ : counts.N++;
                if (dim === 'TF') val > 0 ? counts.T++ : counts.F++;
                if (dim === 'JP') val > 0 ? counts.J++ : counts.P++;
            });

            const getPct = (a, b) => Math.round((a / (a + b)) * 100);

            // Hide test, show result
            screenTest.classList.add('hidden');
            screenResult.classList.remove('hidden');

            // Set Content
            document.getElementById('result-type').textContent = type;
            document.getElementById('result-title').textContent = TYPES[type].title;
            document.getElementById('result-desc').textContent = TYPES[type].desc;

            // Render Bars
            function setBar(dim, leftChar, rightChar, leftCount, rightCount) {
                const leftPct = getPct(leftCount, rightCount);
                const rightPct = 100 - leftPct;

                // Labels e.g. "I: 68%"
                const dominantChar = leftCount >= rightCount ? leftChar : rightChar;
                const dominantPct = leftCount >= rightCount ? leftPct : rightPct;

                // Color Logic: Using Tailwind colors manually for JS
                let colorClass = "";
                if (dim === 'EI') colorClass = "text-cyan-400"; // Just reusing one color for text for now
                if (dim === 'SN') colorClass = "text-purple-400";

                document.getElementById(`score-${dim.toLowerCase()}`).textContent = `${dominantChar}: ${dominantPct}%`;

                // Widths
                // Note: The UI has two bars. Left bar width = leftPct, Right bar width = rightPct?
                // Actually the UI design was:
                // [ Left Bar (Color A) | Right Bar (Color B) ]
                // So width A = leftPct, width B = rightPct.

                document.getElementById(`bar-${leftChar.toLowerCase()}`).style.width = `${leftPct}%`;
                document.getElementById(`bar-${rightChar.toLowerCase()}`).style.width = `${rightPct}%`;

                // Opacity to highlight dominant
                if (leftPct < 50) document.getElementById(`bar-${leftChar.toLowerCase()}`).style.opacity = '0.3';
                if (rightPct < 50) document.getElementById(`bar-${rightChar.toLowerCase()}`).style.opacity = '0.3';
            }

            setBar('EI', 'E', 'I', counts.E, counts.I);
            setBar('SN', 'S', 'N', counts.S, counts.N);
            setBar('TF', 'T', 'F', counts.T, counts.F);
            setBar('JP', 'J', 'P', counts.J, counts.P);
        }

    </script>
</body>

</html>